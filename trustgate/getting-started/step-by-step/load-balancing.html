<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-trustgate/getting-started/step-by-step/load-balancing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Load Balancing | NeuralTrust Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.neuraltrust.ai/img/neuraltrust-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.neuraltrust.ai/img/neuraltrust-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.neuraltrust.ai/trustgate/getting-started/step-by-step/load-balancing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Load Balancing | NeuralTrust Docs"><meta data-rh="true" name="description" content="Load balancing helps distribute AI model requests across multiple instances for better performance and reliability. TrustGate supports multiple load balancing algorithms and health checking capabilities."><meta data-rh="true" property="og:description" content="Load balancing helps distribute AI model requests across multiple instances for better performance and reliability. TrustGate supports multiple load balancing algorithms and health checking capabilities."><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.neuraltrust.ai/trustgate/getting-started/step-by-step/load-balancing"><link data-rh="true" rel="alternate" href="https://docs.neuraltrust.ai/trustgate/getting-started/step-by-step/load-balancing" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.neuraltrust.ai/trustgate/getting-started/step-by-step/load-balancing" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://2RE54Z0R13-dsn.algolia.net" crossorigin="anonymous"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/assets/css/styles.4479c9ab.css">
<script src="/assets/js/runtime~main.7a59e019.js" defer="defer"></script>
<script src="/assets/js/main.1b9cea09.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="NeuralTrust Logo" class="navbar-logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="NeuralTrust Logo" class="navbar-logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">NeuralTrust</b></a><a href="https://app.neuraltrust.ai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Platform<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://neuraltrust.ai/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://neuraltrust.ai/contact" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://github.com/NeuralTrust/TrustGate" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://neuraltrustcommunity.slack.com/join/shared_invite/zt-2xl47cag6-_HFNpltIULnA3wh4R6AqBg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link" aria-label="Slack community"></a><a href="https://linkedin.com/company/neuraltrust" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link" aria-label="LinkedIn page"></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/deployment/overview">⚙️ Deployment</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deployment/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deployment/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/deployment/kubernetes/kubernetes-installation">Kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/deployment/docker/docker-installation">Docker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-main-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/trustgate/overview">🛡️ TrustGate</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/trustgate/getting-started/step-by-step/overview">🚀 Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/get-ai-gateway">Get AI Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/first-gateway">Create Your First Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/configure-upstream">Configure an Upstream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/add-service">Configure a Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/create-rules">Create Rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/getting-started/step-by-step/rate-limiting">Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/trustgate/getting-started/step-by-step/load-balancing">Load Balancing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trustgate/concepts/gateway">💡 Key Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trustgate/guides/provider-load-balancing">📚 Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trustgate/plugins/data-masking">🔌 Plugins</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/benchmark">Benchmark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustgate/monitoring">Monitoring</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-main-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/trusttest/getting-started/overview">🧪 TrustTest</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trusttest/getting-started/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trusttest/getting-started/step-by-step/overview">🚀 Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trusttest/key-concepts/overview">💡 Key Concepts</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-main-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/trustlens/getting-started/overview">🔍 TrustLens</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/trustlens/getting-started/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trustlens/getting-started/step-by-step/overview">🚀 Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/trustlens/key-concepts/analytics">💡 Key Concepts</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-main-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sdks/python-sdk/installation">🛠️ SDKs</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">🛡️ TrustGate</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">🚀 Getting Started</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Load Balancing</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Load Balancing</h1></header>
<p>Load balancing helps distribute AI model requests across multiple instances for better performance and reliability. TrustGate supports multiple load balancing algorithms and health checking capabilities.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-load-balancing">Configure Load Balancing<a href="#configure-load-balancing" class="hash-link" aria-label="Direct link to Configure Load Balancing" title="Direct link to Configure Load Balancing">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-upstream-with-round-robin-strategy">Create an Upstream with Round-Robin Strategy<a href="#create-an-upstream-with-round-robin-strategy" class="hash-link" aria-label="Direct link to Create an Upstream with Round-Robin Strategy" title="Direct link to Create an Upstream with Round-Robin Strategy">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create an upstream with round-robin load balancing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:8080/api/v1/gateways/{gateway-id}/upstreams \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;ai-providers-upstream&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;algorithm&quot;: &quot;round-robin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;targets&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;path&quot;: &quot;/v1/chat/completions&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;provider&quot;: &quot;openai&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;weight&quot;: 50,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;priority&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;default_model&quot;: &quot;gpt-4o-mini&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;models&quot;: [&quot;gpt-3.5-turbo&quot;, &quot;gpt-4&quot;, &quot;gpt-4o-mini&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;credentials&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_name&quot;: &quot;Authorization&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_value&quot;: &quot;Bearer your-openai-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;path&quot;: &quot;/v1/messages&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;provider&quot;: &quot;anthropic&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;weight&quot;: 50,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;priority&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;default_model&quot;: &quot;claude-3-5-sonnet-20241022&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;models&quot;: [&quot;claude-3-5-sonnet-20241022&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;headers&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;anthropic-version&quot;: &quot;2023-06-01&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;credentials&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_name&quot;: &quot;x-api-key&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_value&quot;: &quot;your-anthropic-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;health_checks&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;passive&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;threshold&quot;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;interval&quot;: 60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-upstream-with-weighted-round-robin">Create an Upstream with Weighted Round-Robin<a href="#create-an-upstream-with-weighted-round-robin" class="hash-link" aria-label="Direct link to Create an Upstream with Weighted Round-Robin" title="Direct link to Create an Upstream with Weighted Round-Robin">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create an upstream with weighted distribution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:8080/api/v1/gateways/{gateway-id}/upstreams \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;weighted-upstream&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;algorithm&quot;: &quot;weighted-round-robin&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;targets&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;host&quot;: &quot;api.openai.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;port&quot;: 443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;protocol&quot;: &quot;https&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;weight&quot;: 60,    # 60% of traffic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;priority&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;default_model&quot;: &quot;gpt-4o-mini&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;models&quot;: [&quot;gpt-3.5-turbo&quot;, &quot;gpt-4&quot;, &quot;gpt-4o-mini&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;credentials&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_name&quot;: &quot;Authorization&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_value&quot;: &quot;Bearer your-openai-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;host&quot;: &quot;api.anthropic.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;port&quot;: 443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;protocol&quot;: &quot;https&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;weight&quot;: 40,    # 40% of traffic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;priority&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;default_model&quot;: &quot;claude-3-5-sonnet-20241022&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;models&quot;: [&quot;claude-3-5-sonnet-20241022&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;credentials&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_name&quot;: &quot;Authorization&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;header_value&quot;: &quot;Bearer your-anthropic-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;health_checks&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;passive&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;threshold&quot;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;interval&quot;: 60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-service-using-the-upstream">Create a Service Using the Upstream<a href="#create-a-service-using-the-upstream" class="hash-link" aria-label="Direct link to Create a Service Using the Upstream" title="Direct link to Create a Service Using the Upstream">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create a service that uses the load-balanced upstream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:8080/api/v1/gateways/{gateway-id}/services \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;load-balanced-service&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;type&quot;: &quot;upstream&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;description&quot;: &quot;Load balanced AI service&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;upstream_id&quot;: &quot;{upstream-id}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-routing-rules">Configure Routing Rules<a href="#configure-routing-rules" class="hash-link" aria-label="Direct link to Configure Routing Rules" title="Direct link to Configure Routing Rules">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create a rule to route traffic to the load-balanced service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:8080/api/v1/gateways/{gateway-id}/rules \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;path&quot;: &quot;/ai&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;service_id&quot;: &quot;{service-id}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;methods&quot;: [&quot;POST&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;strip_path&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;active&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="load-balancing-features">Load Balancing Features<a href="#load-balancing-features" class="hash-link" aria-label="Direct link to Load Balancing Features" title="Direct link to Load Balancing Features">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="supported-algorithms">Supported Algorithms<a href="#supported-algorithms" class="hash-link" aria-label="Direct link to Supported Algorithms" title="Direct link to Supported Algorithms">​</a></h3>
<ul>
<li><strong>Round Robin</strong>: Distributes requests evenly across all targets</li>
<li><strong>Weighted Round Robin</strong>: Distributes traffic based on target weights</li>
<li><strong>Least Connections</strong>: Selects the target with the fewest active connections</li>
<li><strong>Random</strong>: Selects a target randomly</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-checks">Health Checks<a href="#health-checks" class="hash-link" aria-label="Direct link to Health Checks" title="Direct link to Health Checks">​</a></h3>
<p>TrustGate supports passive health checking:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;health_checks&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;passive&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Enable passive health checks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;threshold&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Number of failures before marking target as unhealthy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;interval&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Check interval in seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="target-configuration">Target Configuration<a href="#target-configuration" class="hash-link" aria-label="Direct link to Target Configuration" title="Direct link to Target Configuration">​</a></h3>
<p>Each target can be configured with:</p>
<ul>
<li><strong>Weight</strong>: Determines traffic distribution (1-100)</li>
<li><strong>Priority</strong>: Determines target selection order (lower numbers = higher priority)</li>
<li><strong>Protocol</strong>: Supports HTTP/HTTPS</li>
<li><strong>Host/Port</strong>: Target service endpoint</li>
<li><strong>Path</strong>: Target service path</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="payload-transformation">Payload Transformation<a href="#payload-transformation" class="hash-link" aria-label="Direct link to Payload Transformation" title="Direct link to Payload Transformation">​</a></h3>
<p>When using multiple AI providers in an upstream, you need to include fields that cover all providers in your request. The gateway will automatically transform the request for the selected provider.</p>
<p>For example, when load balancing between OpenAI and Anthropic:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;model&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gpt-4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic">// OpenAI model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;messages&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// OpenAI format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;role&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;max_tokens&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                  </span><span class="token comment" style="color:#999988;font-style:italic">// Common field</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;system&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;You are an assistant&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Anthropic system prompt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;temperature&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.7</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// Common field</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The gateway will:</p>
<ol>
<li>Select a target based on the load balancing algorithm</li>
<li>Transform the request to match the selected provider&#x27;s format</li>
<li>Remove unnecessary fields for that provider</li>
<li>Add any required provider-specific headers</li>
</ol>
<p>You don&#x27;t need to handle the transformation yourself - just include all necessary fields in your request, and the gateway will handle the rest based on the provider schemas.</p>
<p>For streaming requests, add <code>&quot;stream&quot;: true</code> to enable streaming for all providers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="priority-based-fallback">Priority-Based Fallback<a href="#priority-based-fallback" class="hash-link" aria-label="Direct link to Priority-Based Fallback" title="Direct link to Priority-Based Fallback">​</a></h3>
<p>Targets can be assigned different priorities to create fallback chains:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;targets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;host&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api.openai.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;priority&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Primary target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;weight&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;host&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api.anthropic.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;priority&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Fallback target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;weight&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When a higher priority target fails:</p>
<ol>
<li>The request automatically fails over to the next priority level</li>
<li>Load balancing continues among targets of the same priority</li>
<li>Health checks determine when to return to higher priority targets</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<ol>
<li>
<p><strong>Health Checking</strong></p>
<ul>
<li>Enable passive health checks for automatic failure detection</li>
<li>Set appropriate threshold values based on your requirements</li>
</ul>
</li>
<li>
<p><strong>Load Distribution</strong></p>
<ul>
<li>Use weighted distribution for heterogeneous targets</li>
<li>Consider target capacity when setting weights</li>
</ul>
</li>
<li>
<p><strong>Monitoring</strong></p>
<ul>
<li>Regularly monitor target health status</li>
<li>Review traffic distribution patterns</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<p>After configuring load balancing:</p>
<ol>
<li><a href="/trustgate/getting-started/step-by-step/rate-limiting">Configure Rate Limiting</a> to protect your services</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/NeuralTrust/neuraltrust/blob/main/docs/trustgate/getting-started/step-by-step/load-balancing.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/trustgate/getting-started/step-by-step/rate-limiting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Rate Limiting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/trustgate/concepts/gateway"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Gateway</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configure-load-balancing" class="table-of-contents__link toc-highlight">Configure Load Balancing</a><ul><li><a href="#create-an-upstream-with-round-robin-strategy" class="table-of-contents__link toc-highlight">Create an Upstream with Round-Robin Strategy</a></li><li><a href="#create-an-upstream-with-weighted-round-robin" class="table-of-contents__link toc-highlight">Create an Upstream with Weighted Round-Robin</a></li></ul></li><li><a href="#create-a-service-using-the-upstream" class="table-of-contents__link toc-highlight">Create a Service Using the Upstream</a></li><li><a href="#configure-routing-rules" class="table-of-contents__link toc-highlight">Configure Routing Rules</a></li><li><a href="#load-balancing-features" class="table-of-contents__link toc-highlight">Load Balancing Features</a><ul><li><a href="#supported-algorithms" class="table-of-contents__link toc-highlight">Supported Algorithms</a></li><li><a href="#health-checks" class="table-of-contents__link toc-highlight">Health Checks</a></li><li><a href="#target-configuration" class="table-of-contents__link toc-highlight">Target Configuration</a></li><li><a href="#payload-transformation" class="table-of-contents__link toc-highlight">Payload Transformation</a></li><li><a href="#priority-based-fallback" class="table-of-contents__link toc-highlight">Priority-Based Fallback</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>