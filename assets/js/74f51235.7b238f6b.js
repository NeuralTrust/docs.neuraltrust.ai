"use strict";(self.webpackChunkneuraltrust_docs=self.webpackChunkneuraltrust_docs||[]).push([[7092],{2235:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"red-teaming/getting-started/step-by-step/create-functional-evaluation-set","title":"Create Functional EvaluationSet","description":"This guide explains how to use the NeuralTrust SDK to create and evaluate a functional EvaluationSet from a RAG.","source":"@site/docs/red-teaming/getting-started/step-by-step/create-functional-evaluation-set.md","sourceDirName":"red-teaming/getting-started/step-by-step","slug":"/red-teaming/getting-started/step-by-step/create-functional-evaluation-set","permalink":"/red-teaming/getting-started/step-by-step/create-functional-evaluation-set","draft":false,"unlisted":false,"editUrl":"https://github.com/NeuralTrust/neuraltrust/blob/main/docs/red-teaming/getting-started/step-by-step/create-functional-evaluation-set.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Configure your LLM endpoint","permalink":"/red-teaming/getting-started/step-by-step/configure-llm-endpoint"},"next":{"title":"Run a Custom Objective Attack","permalink":"/red-teaming/getting-started/step-by-step/run-custom-attack"}}');var a=t(4848),s=t(8453);const r={sidebar_position:3},o="Create Functional EvaluationSet",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Environment Setup",id:"environment-setup",level:2},{value:"Initialize NeuralTrust Client",id:"initialize-neuraltrust-client",level:2},{value:"Build the EvaluationSet",id:"build-the-evaluationset",level:2},{value:"Complete Script",id:"complete-script",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"create-functional-evaluationset",children:"Create Functional EvaluationSet"})}),"\n",(0,a.jsx)(n.p,{children:"This guide explains how to use the NeuralTrust SDK to create and evaluate a functional EvaluationSet from a RAG."}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"This script demonstrates how to:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Set up a knowledge base"}),"\n",(0,a.jsx)(n.li,{children:"Create an EvaluationSet"}),"\n",(0,a.jsx)(n.li,{children:"Generate functional test cases"}),"\n",(0,a.jsx)(n.li,{children:"Run evaluations"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Upstash credentials (URL and token)"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,a.jsx)(n.p,{children:"First, we need to set up our environment and import required packages:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import os\nfrom dotenv import load_dotenv\nfrom neuraltrust import NeuralTrust\n\nload_dotenv()\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The script uses ",(0,a.jsx)(n.code,{children:"python-dotenv"})," to load environment variables from a ",(0,a.jsx)(n.code,{children:".env"})," file. Make sure your ",(0,a.jsx)(n.code,{children:".env"})," file contains:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"NEURALTRUST_API_KEY=your_api_key_here\nUPSTASH_URL=your_upstash_url\nUPSTASH_TOKEN=your_upstash_token\n"})}),"\n",(0,a.jsx)(n.h2,{id:"initialize-neuraltrust-client",children:"Initialize NeuralTrust Client"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'client = NeuralTrust(api_key=os.getenv("NEURALTRUST_API_KEY"))\n'})}),"\n",(0,a.jsx)(n.h2,{id:"build-the-evaluationset",children:"Build the EvaluationSet"}),"\n",(0,a.jsx)(n.p,{children:"Define the topics for which you want to generate TestSets:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'topics = [\n    "Missed flights",\n    "Lost luggage",\n]\n'})}),"\n",(0,a.jsx)(n.p,{children:"Then we will create a knowledge base that retrieves the required context from your Upstash database. This context will be used to generate a targeted EvaluationSet based on your specified topics:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'knowledge_base = client.knowledge_base.create(\n    type="upstash",\n    credentials={\n        "UPSTASH_URL": os.getenv("UPSTASH_URL"),\n        "UPSTASH_TOKEN": os.getenv("UPSTASH_TOKEN"),\n    },\n    seed_topics=[topic],\n)\n'})}),"\n",(0,a.jsx)(n.p,{children:"Creates an EvaluationSet:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'eval_functional = client.evaluation_set.create(\n    name="Functional: " + topic,\n    description="You are a chatbot that answers questions about the Airline topics.",\n)\n'})}),"\n",(0,a.jsx)(n.p,{children:"Generates functional test cases:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'functional_testset = client.testset.create(\n    name=topic,\n    type="functional",\n    evaluation_set_id=eval_functional.id,\n    num_questions=10,\n    knowledge_base_id=knowledge_base.id,\n)\n'})}),"\n",(0,a.jsx)(n.p,{children:"Runs the evaluation:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"client.evaluation_set.run(id=eval_functional.id)\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["This will run the EvaluationSet against the LLM you configured in the NeuralTrust API.\nFor more information on how to configure your LLM, please refer to the ",(0,a.jsx)(n.a,{href:"/red-teaming/getting-started/step-by-step/configure-llm-endpoint",children:"Configure your LLM endpoint"})," guide."]})}),"\n",(0,a.jsx)(n.h2,{id:"complete-script",children:"Complete Script"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'import os\nfrom dotenv import load_dotenv\nfrom neuraltrust import NeuralTrust\n\nload_dotenv()\n\nclient = NeuralTrust(api_key=os.getenv("NEURALTRUST_API_KEY"))\n\ntopics = [\n    "Missed flights",\n    "Lost luggage",\n]\n\nknowledge_base = client.knowledge_base.create(\n    type="upstash",\n    credentials={\n    "UPSTASH_URL": os.getenv("UPSTASH_URL"),\n    "UPSTASH_TOKEN": os.getenv("UPSTASH_TOKEN"),\n},\n    seed_topics=topics,\n)\n\neval_functional = client.evaluation_set.create(\n    name="Functional: " + topic,\n    description="You are a chatbot that answers questions about the Airline topics.",\n)\n\nadversarial_testset = client.testset.create(\n    name=topic,\n    type="functional",\n    evaluation_set_id=eval_functional.id,\n    num_questions=10,\n    knowledge_base_id=knowledge_base.id,\n)\n\nclient.evaluation_set.run(id=eval_functional.id)\n'})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);