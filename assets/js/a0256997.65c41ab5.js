"use strict";(self.webpackChunkneuraltrust_docs=self.webpackChunkneuraltrust_docs||[]).push([[8204],{8164:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"ai-gateway/concepts/traffic-management","title":"Traffic Management","description":"The AI Gateway provides advanced traffic management capabilities to control how requests are distributed across multiple targets.","source":"@site/docs/ai-gateway/concepts/traffic-management.md","sourceDirName":"ai-gateway/concepts","slug":"/ai-gateway/concepts/traffic-management","permalink":"/neuraltrust/ai-gateway/concepts/traffic-management","draft":false,"unlisted":false,"editUrl":"https://github.com/NeuralTrust/neuraltrust/blob/main/docs/ai-gateway/concepts/traffic-management.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Plugin System","permalink":"/neuraltrust/ai-gateway/concepts/plugin-system"},"next":{"title":"Plugins","permalink":"/neuraltrust/category/plugins"}}');var s=t(4848),r=t(8453);const a={sidebar_position:3},l="Traffic Management",c={},o=[{value:"Distribution Methods",id:"distribution-methods",level:2},{value:"Round-Robin Distribution",id:"round-robin-distribution",level:3},{value:"Weighted Distribution",id:"weighted-distribution",level:3},{value:"Technical Implementation",id:"technical-implementation",level:2},{value:"Architecture",id:"architecture",level:3},{value:"Features",id:"features",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"Canary Deployments",id:"canary-deployments",level:3},{value:"A/B Testing",id:"ab-testing",level:3},{value:"Blue/Green Deployment",id:"bluegreen-deployment",level:3},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"traffic-management",children:"Traffic Management"})}),"\n",(0,s.jsx)(n.p,{children:"The AI Gateway provides advanced traffic management capabilities to control how requests are distributed across multiple targets."}),"\n",(0,s.jsx)(n.h2,{id:"distribution-methods",children:"Distribution Methods"}),"\n",(0,s.jsx)(n.h3,{id:"round-robin-distribution",children:"Round-Robin Distribution"}),"\n",(0,s.jsx)(n.p,{children:"Requests are distributed evenly across all targets in a sequential, circular order. This is the default method when no weights are specified."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:8080/api/v1/tenants/{tenant_id}/rules \\\n  -H "Authorization: Bearer {api_key}" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "path": "/api/*",\n    "targets": [\n      {"url": "https://api1.example.com"},\n      {"url": "https://api2.example.com"},\n      {"url": "https://api3.example.com"}\n    ],\n    "methods": ["GET", "POST"],\n    "strip_path": true\n  }\'\n'})}),"\n",(0,s.jsx)(n.h3,{id:"weighted-distribution",children:"Weighted Distribution"}),"\n",(0,s.jsx)(n.p,{children:"Enables percentage-based traffic distribution across targets. Useful for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Canary deployments"}),"\n",(0,s.jsx)(n.li,{children:"A/B testing"}),"\n",(0,s.jsx)(n.li,{children:"Gradual migrations"}),"\n",(0,s.jsx)(n.li,{children:"Blue/Green deployments"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:8080/api/v1/tenants/{tenant_id}/rules \\\n  -H "Authorization: Bearer {api_key}" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "path": "/api/*",\n    "targets": [\n      {\n        "url": "https://production.example.com",\n        "weight": 90\n      },\n      {\n        "url": "https://canary.example.com",\n        "weight": 10\n      }\n    ],\n    "methods": ["GET", "POST"],\n    "strip_path": true\n  }\'\n'})}),"\n",(0,s.jsx)(n.h2,{id:"technical-implementation",children:"Technical Implementation"}),"\n",(0,s.jsx)(n.h3,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Uses Redis for distributed counter management"}),"\n",(0,s.jsx)(n.li,{children:"Ensures consistent distribution across gateway instances"}),"\n",(0,s.jsx)(n.li,{children:"Includes automatic fallback mechanisms"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Distributed Counters"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Redis-based counter management"}),"\n",(0,s.jsx)(n.li,{children:"TTL to prevent memory leaks"}),"\n",(0,s.jsx)(n.li,{children:"Automatic cleanup"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Fallback Mechanisms"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Defaults to round-robin if weights don't sum to 100%"}),"\n",(0,s.jsx)(n.li,{children:"Random selection during Redis failures"}),"\n",(0,s.jsx)(n.li,{children:"Automatic error recovery"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Health Checks"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Active target health monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Automatic failing target removal"}),"\n",(0,s.jsx)(n.li,{children:"Health status restoration"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsx)(n.h3,{id:"canary-deployments",children:"Canary Deployments"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "targets": [\n    {\n      "url": "https://stable.example.com",\n      "weight": 95\n    },\n    {\n      "url": "https://canary.example.com",\n      "weight": 5\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"ab-testing",children:"A/B Testing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "targets": [\n    {\n      "url": "https://variant-a.example.com",\n      "weight": 50\n    },\n    {\n      "url": "https://variant-b.example.com",\n      "weight": 50\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"bluegreen-deployment",children:"Blue/Green Deployment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "targets": [\n    {\n      "url": "https://blue.example.com",\n      "weight": 100\n    },\n    {\n      "url": "https://green.example.com",\n      "weight": 0\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Gradual Rollouts"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Start with small weights for new versions"}),"\n",(0,s.jsx)(n.li,{children:"Gradually increase based on monitoring"}),"\n",(0,s.jsx)(n.li,{children:"Have rollback plans ready"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Monitoring"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Track error rates per target"}),"\n",(0,s.jsx)(n.li,{children:"Monitor response times"}),"\n",(0,s.jsx)(n.li,{children:"Set up alerts for anomalies"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Health Checks"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configure appropriate timeouts"}),"\n",(0,s.jsx)(n.li,{children:"Set realistic health thresholds"}),"\n",(0,s.jsx)(n.li,{children:"Monitor health check logs"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);