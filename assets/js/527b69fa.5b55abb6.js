"use strict";(self.webpackChunkneuraltrust_docs=self.webpackChunkneuraltrust_docs||[]).push([[3189],{9231:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"trustgate/plugins/injection-protection","title":"Injection Protection","description":"Technical Overview","source":"@site/docs/trustgate/plugins/injection-protection.md","sourceDirName":"trustgate/plugins","slug":"/trustgate/plugins/injection-protection","permalink":"/trustgate/plugins/injection-protection","draft":false,"unlisted":false,"editUrl":"https://github.com/NeuralTrust/neuraltrust/blob/main/docs/trustgate/plugins/injection-protection.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Injection Protection"},"sidebar":"tutorialSidebar","previous":{"title":"Code Sanitation","permalink":"/trustgate/plugins/code-sanitation"},"next":{"title":"Request Size Limiter","permalink":"/trustgate/plugins/request-size-limiter"}}');var r=i(4848),l=i(8453);const t={sidebar_position:8,title:"Injection Protection"},c="Injection Protection",d={},o=[{value:"Technical Overview",id:"technical-overview",level:2},{value:"Core Components",id:"core-components",level:3},{value:"Attack Detection Details",id:"attack-detection-details",level:2},{value:"SQL Injection Detection",id:"sql-injection-detection",level:3},{value:"Command Injection Detection",id:"command-injection-detection",level:3},{value:"Path Traversal Detection",id:"path-traversal-detection",level:3},{value:"SSRF Detection",id:"ssrf-detection",level:3},{value:"Processing Pipeline",id:"processing-pipeline",level:2},{value:"Configuration Details",id:"configuration-details",level:2},{value:"Pattern Types",id:"pattern-types",level:3},{value:"Content Analysis",id:"content-analysis",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Pattern Matching",id:"pattern-matching",level:3},{value:"Request Processing",id:"request-processing",level:3},{value:"Memory Management",id:"memory-management",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Types of Errors",id:"types-of-errors",level:3},{value:"Error Responses",id:"error-responses",level:3},{value:"Features",id:"features",level:2},{value:"Attack Types",id:"attack-types",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Configuration Parameters",id:"configuration-parameters",level:3},{value:"Usage Example",id:"usage-example",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"injection-protection",children:"Injection Protection"})}),"\n",(0,r.jsx)(e.h2,{id:"technical-overview",children:"Technical Overview"}),"\n",(0,r.jsx)(e.p,{children:"The Injection Protection plugin implements a multi-layered defense system to detect and block various injection attacks. It operates in the pre-request stage and analyzes all parts of incoming HTTP requests."}),"\n",(0,r.jsx)(e.h3,{id:"core-components",children:"Core Components"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Pattern Detection Engine"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Pre-compiled regular expressions for performance"}),"\n",(0,r.jsx)(e.li,{children:"Case-insensitive pattern matching"}),"\n",(0,r.jsx)(e.li,{children:"Support for complex attack patterns"}),"\n",(0,r.jsx)(e.li,{children:"Custom pattern registration"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Request Analyzer"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Multi-part request analysis (headers, query, body)"}),"\n",(0,r.jsx)(e.li,{children:"JSON and form-data parsing"}),"\n",(0,r.jsx)(e.li,{children:"Recursive object traversal"}),"\n",(0,r.jsx)(e.li,{children:"UTF-8 encoding support"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Attack Detection System"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Real-time pattern matching"}),"\n",(0,r.jsx)(e.li,{children:"Concurrent request processing"}),"\n",(0,r.jsx)(e.li,{children:"Early termination on detection"}),"\n",(0,r.jsx)(e.li,{children:"Detailed attack logging"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"attack-detection-details",children:"Attack Detection Details"}),"\n",(0,r.jsx)(e.h3,{id:"sql-injection-detection",children:"SQL Injection Detection"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Union-based Attacks"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"UNION SELECT statements"}),"\n",(0,r.jsx)(e.li,{children:"Stacked queries"}),"\n",(0,r.jsx)(e.li,{children:"Comment-based injections"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Error-based Attacks"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Type conversion attacks"}),"\n",(0,r.jsx)(e.li,{children:"XPATH errors"}),"\n",(0,r.jsx)(e.li,{children:"Syntax errors"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Time-based Attacks"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"SLEEP() functions"}),"\n",(0,r.jsx)(e.li,{children:"BENCHMARK() calls"}),"\n",(0,r.jsx)(e.li,{children:"Heavy queries"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"command-injection-detection",children:"Command Injection Detection"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Shell Commands"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"System command execution"}),"\n",(0,r.jsx)(e.li,{children:"Process spawning"}),"\n",(0,r.jsx)(e.li,{children:"Command chaining"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Shell Shock Patterns"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Environment variables"}),"\n",(0,r.jsx)(e.li,{children:"Function definitions"}),"\n",(0,r.jsx)(e.li,{children:"Command substitution"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Command Separators"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Semicolons"}),"\n",(0,r.jsx)(e.li,{children:"Pipes"}),"\n",(0,r.jsx)(e.li,{children:"Backticks"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"path-traversal-detection",children:"Path Traversal Detection"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Directory Navigation"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Parent directory references"}),"\n",(0,r.jsx)(e.li,{children:"Absolute paths"}),"\n",(0,r.jsx)(e.li,{children:"Symbolic links"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Encoding Variations"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"URL encoding"}),"\n",(0,r.jsx)(e.li,{children:"Double encoding"}),"\n",(0,r.jsx)(e.li,{children:"Unicode variants"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"ssrf-detection",children:"SSRF Detection"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"URL Schemes"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"File protocol"}),"\n",(0,r.jsx)(e.li,{children:"HTTP/HTTPS"}),"\n",(0,r.jsx)(e.li,{children:"Data URIs"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Internal Access"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Localhost references"}),"\n",(0,r.jsx)(e.li,{children:"Private IP ranges"}),"\n",(0,r.jsx)(e.li,{children:"DNS rebinding"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"processing-pipeline",children:"Processing Pipeline"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Request Parsing"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Header extraction"}),"\n",(0,r.jsx)(e.li,{children:"Query parameter parsing"}),"\n",(0,r.jsx)(e.li,{children:"Body deserialization"}),"\n",(0,r.jsx)(e.li,{children:"Content type handling"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Pattern Matching"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Regular expression evaluation"}),"\n",(0,r.jsx)(e.li,{children:"Custom pattern checking"}),"\n",(0,r.jsx)(e.li,{children:"Threshold validation"}),"\n",(0,r.jsx)(e.li,{children:"Attack categorization"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Decision Making"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Threat scoring"}),"\n",(0,r.jsx)(e.li,{children:"Action determination"}),"\n",(0,r.jsx)(e.li,{children:"Response generation"}),"\n",(0,r.jsx)(e.li,{children:"Error handling"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Response Generation"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Status code selection"}),"\n",(0,r.jsx)(e.li,{children:"Error message formatting"}),"\n",(0,r.jsx)(e.li,{children:"Header modification"}),"\n",(0,r.jsx)(e.li,{children:"Logging and metrics"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"configuration-details",children:"Configuration Details"}),"\n",(0,r.jsx)(e.h3,{id:"pattern-types",children:"Pattern Types"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Predefined Patterns"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Built-in security rules"}),"\n",(0,r.jsx)(e.li,{children:"Common attack signatures"}),"\n",(0,r.jsx)(e.li,{children:"Updated regularly"}),"\n",(0,r.jsx)(e.li,{children:"Performance optimized"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Custom Patterns"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"User-defined rules"}),"\n",(0,r.jsx)(e.li,{children:"Regular expressions"}),"\n",(0,r.jsx)(e.li,{children:"Pattern descriptions"}),"\n",(0,r.jsx)(e.li,{children:"Priority settings"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"content-analysis",children:"Content Analysis"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Header Analysis"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Key-value pair checking"}),"\n",(0,r.jsx)(e.li,{children:"Size validation"}),"\n",(0,r.jsx)(e.li,{children:"Encoding verification"}),"\n",(0,r.jsx)(e.li,{children:"Protocol compliance"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Query Analysis"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Parameter inspection"}),"\n",(0,r.jsx)(e.li,{children:"Value validation"}),"\n",(0,r.jsx)(e.li,{children:"Encoding checks"}),"\n",(0,r.jsx)(e.li,{children:"Length limits"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Body Analysis"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Content parsing"}),"\n",(0,r.jsx)(e.li,{children:"Deep object inspection"}),"\n",(0,r.jsx)(e.li,{children:"Array handling"}),"\n",(0,r.jsx)(e.li,{children:"Size validation"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsx)(e.h3,{id:"pattern-matching",children:"Pattern Matching"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Pre-compiled patterns"}),"\n",(0,r.jsx)(e.li,{children:"Early termination"}),"\n",(0,r.jsx)(e.li,{children:"Memory efficient"}),"\n",(0,r.jsx)(e.li,{children:"CPU optimized"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"request-processing",children:"Request Processing"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Concurrent handling"}),"\n",(0,r.jsx)(e.li,{children:"Buffered reading"}),"\n",(0,r.jsx)(e.li,{children:"Streaming support"}),"\n",(0,r.jsx)(e.li,{children:"Resource limits"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"memory-management",children:"Memory Management"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Zero-copy where possible"}),"\n",(0,r.jsx)(e.li,{children:"Buffer pooling"}),"\n",(0,r.jsx)(e.li,{children:"Garbage collection friendly"}),"\n",(0,r.jsx)(e.li,{children:"Memory limits"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(e.h3,{id:"types-of-errors",children:"Types of Errors"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Validation Errors"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Invalid patterns"}),"\n",(0,r.jsx)(e.li,{children:"Malformed requests"}),"\n",(0,r.jsx)(e.li,{children:"Size violations"}),"\n",(0,r.jsx)(e.li,{children:"Encoding issues"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Runtime Errors"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Timeout errors"}),"\n",(0,r.jsx)(e.li,{children:"Resource exhaustion"}),"\n",(0,r.jsx)(e.li,{children:"System errors"}),"\n",(0,r.jsx)(e.li,{children:"Network issues"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Security Events"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Attack detection"}),"\n",(0,r.jsx)(e.li,{children:"Pattern matches"}),"\n",(0,r.jsx)(e.li,{children:"Threshold violations"}),"\n",(0,r.jsx)(e.li,{children:"Policy breaches"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"error-responses",children:"Error Responses"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Detailed error codes"}),"\n",(0,r.jsx)(e.li,{children:"Custom messages"}),"\n",(0,r.jsx)(e.li,{children:"Logging integration"}),"\n",(0,r.jsx)(e.li,{children:"Metrics collection"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Multiple attack type detection (SQL, NoSQL, Command, Path Traversal, etc.)"}),"\n",(0,r.jsx)(e.li,{children:"Configurable blocking actions"}),"\n",(0,r.jsx)(e.li,{children:"Pattern-based detection with regular expressions"}),"\n",(0,r.jsx)(e.li,{children:"Support for custom patterns"}),"\n",(0,r.jsx)(e.li,{children:"Request content analysis (headers, path, query, body)"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"attack-types",children:"Attack Types"}),"\n",(0,r.jsx)(e.p,{children:"The plugin detects the following types of attacks:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Attack Type"}),(0,r.jsx)(e.th,{children:"Description"}),(0,r.jsx)(e.th,{children:"Example Pattern"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SQL"}),(0,r.jsx)(e.td,{children:"SQL injection attempts"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"UNION SELECT"}),", ",(0,r.jsx)(e.code,{children:"DROP TABLE"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"NoSQL"}),(0,r.jsx)(e.td,{children:"MongoDB injection patterns"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"$where"}),", ",(0,r.jsx)(e.code,{children:"$regex"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Command"}),(0,r.jsx)(e.td,{children:"Shell command injection"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"system()"}),", ",(0,r.jsx)(e.code,{children:"exec()"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Path Traversal"}),(0,r.jsx)(e.td,{children:"Directory traversal attempts"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"../"}),", ",(0,r.jsx)(e.code,{children:"..\\\\"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"LDAP"}),(0,r.jsx)(e.td,{children:"LDAP injection patterns"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"(cn=*)"}),", `("]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"XML"}),(0,r.jsx)(e.td,{children:"XML injection and XXE"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"<!ENTITY"}),", ",(0,r.jsx)(e.code,{children:"SYSTEM"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SSRF"}),(0,r.jsx)(e.td,{children:"Server-side request forgery"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"file://"}),", ",(0,r.jsx)(e.code,{children:"dict://"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"File Inclusion"}),(0,r.jsx)(e.td,{children:"Local/Remote file inclusion"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"include()"}),", ",(0,r.jsx)(e.code,{children:"require()"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Template"}),(0,r.jsx)(e.td,{children:"Template injection attempts"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"{{.}}"}),", ",(0,r.jsx)(e.code,{children:"${...}"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"XPath"}),(0,r.jsx)(e.td,{children:"XPath injection patterns"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"//"}),", ",(0,r.jsx)(e.code,{children:"contains()"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Header"}),(0,r.jsx)(e.td,{children:"HTTP header injection"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"\\r\\n"}),", ",(0,r.jsx)(e.code,{children:"\\n\\n"})]})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "name": "injection_protection",\n  "enabled": true,\n  "stage": "pre_request",\n  "settings": {\n    "content_to_check": ["headers", "path_and_query", "body"],\n    "action": "block",\n    "status_code": 400,\n    "error_message": "Potential security threat detected",\n    "predefined_injections": [\n      {\n        "type": "sql",\n        "enabled": true\n      },\n      {\n        "type": "command",\n        "enabled": true\n      }\n    ],\n    "custom_patterns": [\n      {\n        "name": "custom_pattern",\n        "pattern": "malicious.*pattern",\n        "description": "Custom malicious pattern"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Parameter"}),(0,r.jsx)(e.th,{children:"Type"}),(0,r.jsx)(e.th,{children:"Description"}),(0,r.jsx)(e.th,{children:"Required"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"content_to_check"}),(0,r.jsx)(e.td,{children:"array"}),(0,r.jsx)(e.td,{children:"Request parts to analyze"}),(0,r.jsx)(e.td,{children:"Yes"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"action"}),(0,r.jsx)(e.td,{children:"string"}),(0,r.jsx)(e.td,{children:"Action to take when attack detected"}),(0,r.jsx)(e.td,{children:"Yes"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"status_code"}),(0,r.jsx)(e.td,{children:"number"}),(0,r.jsx)(e.td,{children:"HTTP status code for blocked requests"}),(0,r.jsx)(e.td,{children:"No"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"error_message"}),(0,r.jsx)(e.td,{children:"string"}),(0,r.jsx)(e.td,{children:"Custom error message"}),(0,r.jsx)(e.td,{children:"No"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"predefined_injections"}),(0,r.jsx)(e.td,{children:"array"}),(0,r.jsx)(e.td,{children:"List of enabled attack types"}),(0,r.jsx)(e.td,{children:"Yes"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"custom_patterns"}),(0,r.jsx)(e.td,{children:"array"}),(0,r.jsx)(e.td,{children:"Custom regex patterns"}),(0,r.jsx)(e.td,{children:"No"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"usage-example",children:"Usage Example"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'curl -X POST "http://localhost:8080/api/v1/gateways" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "Protected Gateway",\n    "subdomain": "protected",\n    "required_plugins": [\n      {\n        "name": "injection_protection",\n        "enabled": true,\n        "stage": "pre_request",\n        "settings": {\n          "content_to_check": ["headers", "path_and_query", "body"],\n          "action": "block",\n          "status_code": 400,\n          "predefined_injections": [\n            {\n              "type": "sql",\n              "enabled": true\n            },\n            {\n              "type": "command",\n              "enabled": true\n            }\n          ]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,r.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Enable Multiple Attack Types"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Enable relevant attack types for your application"}),"\n",(0,r.jsx)(e.li,{children:"Consider your application's attack surface"}),"\n",(0,r.jsx)(e.li,{children:"Balance security vs false positives"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Content Selection"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Check all relevant request parts"}),"\n",(0,r.jsx)(e.li,{children:"Consider performance impact"}),"\n",(0,r.jsx)(e.li,{children:"Monitor for false positives"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Custom Patterns"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Keep patterns specific and targeted"}),"\n",(0,r.jsx)(e.li,{children:"Test thoroughly before deployment"}),"\n",(0,r.jsx)(e.li,{children:"Document pattern purposes"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Error Messages"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Use informative but safe messages"}),"\n",(0,r.jsx)(e.li,{children:"Avoid revealing system details"}),"\n",(0,r.jsx)(e.li,{children:"Log detailed information internally"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Uses pre-compiled regex patterns"}),"\n",(0,r.jsx)(e.li,{children:"Efficient request parsing"}),"\n",(0,r.jsx)(e.li,{children:"Minimal memory footprint"}),"\n",(0,r.jsx)(e.li,{children:"Linear scaling with request size"}),"\n",(0,r.jsx)(e.li,{children:"Concurrent processing support"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>t,x:()=>c});var s=i(6540);const r={},l=s.createContext(r);function t(n){const e=s.useContext(l);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),s.createElement(l.Provider,{value:e},n.children)}}}]);