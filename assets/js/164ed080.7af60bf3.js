"use strict";(self.webpackChunkneuraltrust_docs=self.webpackChunkneuraltrust_docs||[]).push([[7991],{2676:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"trustgate/getting-started/step-by-step/rate-limiting","title":"Rate Limiting","description":"TrustGate provides two complementary rate limiting mechanisms: request-based and token-based rate limiting. These systems work together to protect your AI models and ensure fair resource distribution.","source":"@site/docs/trustgate/getting-started/step-by-step/rate-limiting.md","sourceDirName":"trustgate/getting-started/step-by-step","slug":"/trustgate/getting-started/step-by-step/rate-limiting","permalink":"/trustgate/getting-started/step-by-step/rate-limiting","draft":false,"unlisted":false,"editUrl":"https://github.com/NeuralTrust/neuraltrust/blob/main/docs/trustgate/getting-started/step-by-step/rate-limiting.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Rate Limiting"},"sidebar":"tutorialSidebar","previous":{"title":"Create Rules","permalink":"/trustgate/getting-started/step-by-step/create-rules"},"next":{"title":"Load Balancing","permalink":"/trustgate/getting-started/step-by-step/load-balancing"}}');var t=i(4848),r=i(8453);const l={sidebar_position:8,title:"Rate Limiting"},d="Rate Limiting",o={},a=[{value:"Request-Based Rate Limiting",id:"request-based-rate-limiting",level:2},{value:"Limit Types",id:"limit-types",level:3},{value:"Configuration Example",id:"configuration-example",level:3},{value:"Window Configuration",id:"window-configuration",level:3},{value:"Limit Processing Order",id:"limit-processing-order",level:3},{value:"Token-Based Rate Limiting",id:"token-based-rate-limiting",level:2},{value:"Configuration Example",id:"configuration-example-1",level:3},{value:"Token Bucket Algorithm",id:"token-bucket-algorithm",level:3},{value:"How It Works",id:"how-it-works",level:4},{value:"Visual Example",id:"visual-example",level:4},{value:"Advantages",id:"advantages",level:4},{value:"Response Headers",id:"response-headers",level:2},{value:"Request Rate Limit Headers",id:"request-rate-limit-headers",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"rate-limiting",children:"Rate Limiting"})}),"\n",(0,t.jsx)(n.p,{children:"TrustGate provides two complementary rate limiting mechanisms: request-based and token-based rate limiting. These systems work together to protect your AI models and ensure fair resource distribution."}),"\n",(0,t.jsx)(n.h2,{id:"request-based-rate-limiting",children:"Request-Based Rate Limiting"}),"\n",(0,t.jsx)(n.p,{children:"The request-based rate limiter implements a sliding window algorithm using Redis for distributed rate limiting. It supports multiple limit types that can be applied simultaneously."}),"\n",(0,t.jsx)(n.h3,{id:"limit-types",children:"Limit Types"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["Per IP Limiting (",(0,t.jsx)(n.code,{children:"per_ip"}),")"]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tracks requests by client IP address"}),"\n",(0,t.jsxs)(n.li,{children:["Supports multiple IP headers for proxy environments:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"X-Real-IP"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"X-Forwarded-For"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"X-Original-Forwarded-For"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"True-Client-IP"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"CF-Connecting-IP"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["Per User Limiting (",(0,t.jsx)(n.code,{children:"per_user"}),")"]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tracks requests by user identifier"}),"\n",(0,t.jsxs)(n.li,{children:["Supported user ID headers:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"X-User-ID"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"X-User-Id"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"X-UserID"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"User-ID"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:'Falls back to "anonymous" if no user ID found'}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["Global Limiting (",(0,t.jsx)(n.code,{children:"global"}),")"]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Applies across all users"}),"\n",(0,t.jsx)(n.li,{children:"Controls total gateway throughput"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"configuration-example",children:"Configuration Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "rate_limiter",\n  "enabled": true,\n  "stage": "pre_request",\n  "settings": {\n    "limits": {\n      "global": {\n        "limit": 1000,\n        "window": "1m"\n      },\n      "per_ip": {\n        "limit": 100,\n        "window": "1m"\n      },\n      "per_user": {\n        "limit": 50,\n        "window": "1m"\n      }\n    },\n    "actions": {\n      "type": "reject",\n      "retry_after": "60"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"window-configuration",children:"Window Configuration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Uses sliding window algorithm"}),"\n",(0,t.jsxs)(n.li,{children:["Supports time units: ",(0,t.jsx)(n.code,{children:"s"})," (seconds), ",(0,t.jsx)(n.code,{children:"m"})," (minutes), ",(0,t.jsx)(n.code,{children:"h"})," (hours)"]}),"\n",(0,t.jsxs)(n.li,{children:["Example durations:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"1m"'}),": One minute window"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"1h"'}),": One hour window"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"24h"'}),": One day window"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"limit-processing-order",children:"Limit Processing Order"}),"\n",(0,t.jsx)(n.p,{children:"The rate limiter checks limits in the following order:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Per IP limits"}),"\n",(0,t.jsx)(n.li,{children:"Per User limits"}),"\n",(0,t.jsx)(n.li,{children:"Global limits"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"If any limit is exceeded, the request is rejected immediately."}),"\n",(0,t.jsx)(n.h2,{id:"token-based-rate-limiting",children:"Token-Based Rate Limiting"}),"\n",(0,t.jsx)(n.p,{children:"Token-based rate limiting is specifically designed for AI model interactions, controlling the number of tokens consumed rather than just request counts."}),"\n",(0,t.jsx)(n.h3,{id:"configuration-example-1",children:"Configuration Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "token_rate_limiter",\n  "enabled": true,\n  "settings": {\n    "tokens_per_request": 1000,    // Maximum tokens per request\n    "tokens_per_minute": 10000,    // Token replenishment rate\n    "bucket_size": 50000,         // Maximum token capacity\n    "requests_per_minute": 60     // Request count limit\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"token-bucket-algorithm",children:"Token Bucket Algorithm"}),"\n",(0,t.jsx)(n.p,{children:"The token bucket algorithm provides smooth rate limiting for AI model interactions. Think of it as a bucket that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Has a maximum capacity (",(0,t.jsx)(n.code,{children:"bucket_size"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Fills at a constant rate (",(0,t.jsx)(n.code,{children:"tokens_per_minute"}),")"]}),"\n",(0,t.jsx)(n.li,{children:"Drains tokens as requests are processed"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"how-it-works",children:"How It Works"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Token Accumulation"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Tokens are added to the bucket at a constant rate (",(0,t.jsx)(n.code,{children:"tokens_per_minute"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["The bucket can hold up to ",(0,t.jsx)(n.code,{children:"bucket_size"})," tokens"]}),"\n",(0,t.jsx)(n.li,{children:"If the bucket is full, new tokens are discarded"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Processing"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Each request consumes a number of tokens"}),"\n",(0,t.jsx)(n.li,{children:"The actual consumption is based on the request size"}),"\n",(0,t.jsx)(n.li,{children:"If insufficient tokens, request is rejected"}),"\n",(0,t.jsxs)(n.li,{children:["Default consumption is ",(0,t.jsx)(n.code,{children:"tokens_per_request"})," if actual usage can't be determined"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Burst Handling"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The bucket size allows for temporary bursts of traffic"}),"\n",(0,t.jsxs)(n.li,{children:["Example: with settings:","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "tokens_per_minute": 10000,    // 10k tokens per minute\n  "bucket_size": 50000,          // Can burst up to 50k tokens\n  "tokens_per_request": 1000     // Each request needs 1k tokens\n}\n'})}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Normal rate: 10 requests/minute (1k tokens each)"}),"\n",(0,t.jsx)(n.li,{children:"Burst capacity: Up to 50 requests if bucket is full"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"visual-example",children:"Visual Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Bucket Capacity: 50,000 tokens\n\u2502\n\u251c\u2500 Full Bucket (50,000 tokens)\n\u2502  \u2514\u2500 Can handle burst of 50 requests\n\u2502\n\u251c\u2500 Normal Operation (10,000 tokens/minute)\n\u2502  \u251c\u2500 Tokens added: 166/second\n\u2502  \u2514\u2500 Supports: 10 requests/minute\n\u2502\n\u2514\u2500 Empty Bucket (0 tokens)\n   \u2514\u2500 Must wait for token replenishment\n"})}),"\n",(0,t.jsx)(n.h4,{id:"advantages",children:"Advantages"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Smooth Rate Limiting"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Natural traffic shaping"}),"\n",(0,t.jsx)(n.li,{children:"Prevents sharp cutoffs"}),"\n",(0,t.jsx)(n.li,{children:"Allows for burst handling"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Fair Resource Distribution"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tokens correspond to actual resource usage"}),"\n",(0,t.jsx)(n.li,{children:"Large requests consume more tokens"}),"\n",(0,t.jsx)(n.li,{children:"Small requests consume fewer tokens"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Predictable Capacity"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Clear maximum burst size"}),"\n",(0,t.jsx)(n.li,{children:"Known replenishment rate"}),"\n",(0,t.jsx)(n.li,{children:"Easy capacity planning"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Flexible Configuration"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Adjustable bucket size for burst handling"}),"\n",(0,t.jsx)(n.li,{children:"Configurable replenishment rate"}),"\n",(0,t.jsx)(n.li,{children:"Custom tokens per request"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"response-headers",children:"Response Headers"}),"\n",(0,t.jsx)(n.h3,{id:"request-rate-limit-headers",children:"Request Rate Limit Headers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>d});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);